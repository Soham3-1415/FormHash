const form  = document.getElementsByTagName('form')[0];
const email = document.getElementById('email');
const submit = document.getElementById('submit_button');
const q1 = document.getElementById('q1');
const q2 = document.getElementById('q2');
const q3 = document.getElementById('q3');
const emailError = email.parentElement.getElementsByTagName('span')[0]; // This is poorly designed
const q1Error = q1.parentElement.getElementsByTagName('span')[0]; // This is poorly designed
const q2Error = q2.parentElement.getElementsByTagName('span')[0]; //poor design
const q3Error = q3.parentElement.getElementsByTagName('span')[0]; //poor design

const q1CombHash = "d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35";
const q2CombHash = "9455f6681430a1d135ee4ace63084b5c6cf5d3af164698a5a53c005e46dac360A3bb28a544bed13c07ed0dd3fbb1230519ee57db010a7b64e2bcb49da26ff19c2A43fab012fad0377b45a1fc7c794f3af1ea80980be50f10a5318e3cf4c6101e70A92801676e2abbe1a01050645ea85177ca83199fb9e04262c860548b4ee63f98fAb4284008e00ebb23a3503d59a27dbd6a2fca161729a373f0a7d417646ebf6628A82d3bc8d972c73aa0cc34833dcaf83091a5013e16e211918bf35101d0bab52d1A185640c9448b27a614a8ea811815332726d02c750d9ca720c9e23256c6e6ed26Afa90adf20ce168fe2f1e06ad111b1c35c1ff9acc94be5491b4d1d633ee63e33dA79b638d9e9ed27cd0608c91447fef9736ae97fb083b507a42e07e9ffdbcd2700A7fa7c2fdc3f9fbf71b3c32f3b145715b9c888f916ba96dbb271cb67511095904A4c62bf1ba68241a23e59dd877d72f855bb04475d8bc568b5bec23ed1563238b2A08b5b5da1b93ecc3b08ef3f009509ad9b6e6f440a3963f4f9492fba39893841cAb5ca0a343e69dce8c30702b636c22871c129365f0eb9df81966f8e94f4c049b1A15ce4f5dd17bd4b181c962243f966dcac3f5a9b9eb9ca5aacb1b194c563dbadfAc30ff86e882b6c0256b624c455ca80510863e23b808db4ac2de446942e19e013Ae18ebaabb9f2fba0f9acbcf84e1e8bfdaa041eb52c186612c7d900d94378abf5A";
const q3CombHash = "6dd8a117a9ab33e87bfc23e5312f4379d4065f613181118ff2119d87d68054fcA2f7d2bd15ee828fd8854fdb9a9993210f16257165ce56ac5eae58a280a818dafA740e37087f7e0df1f2aef2b322f45475fc90210ef3009dfb96617a43130dc300Aacc9def34f2c2399e983fc493b6cd45801a422d0ee6e6d4461e9cfbdb5833ee4Ab55fea69455abc96ee91945fc04e2ecaa2696b2d86c62f93d0a969b6d86b3bafA1687bc462092aaede4275130571d8fc717c7822c359c6857bff8313fcb296fd4Afda20b22f1dcd489628a5c649c391b40298185aa5eacf9765dc261c891166482Aa8085bb51ada31ce96863586502bd1dbe0562750de27da22045856043dcbb564Aa498e2b2feb78a248bda66e211edb858b546a52c715e4d4a2db9c86b64febe7dAe95006169d7bf9c0501a4ffe8e03f1583fb955cbca2523f12c1f44e4e90c1845Aa8a5294c6913aa4ada32d3e5b7d3a73ac33a0153ce1093ee1dfc3f497bfe61fcA02973a31af7135f8d6b8513fbf8df69d3378e6c065d4230d934f8a016daf1bd1A53567f34f1af5536ee6a5f916a875e159b9b1a5a2f853c73009c6cff387f4955A874590c50b74e1c139ba693a4699e641c10eda10ac13e25f62ba6e33b1030b29A3d5691846cbae3634af5adf47980e339db732809c7a66aff70616b878b1ce5f5A2cb889e3090cfa2ccd97bc8ee192c888fb542eb0915bd4836e6e814cc77078c2Ae1e6b927e5c25076178d4b1a96ffe796af015203e3327ca3496e4ad50898e1f2A8aeb356bef2f32b660af8b4468e5560308f133017664dbcebfb11cd127bf1394Aab37356c53a91867c2a33ac0da376dff95a28054d841cf44b5d5020006b0f259Aae8dfcd19abd217ce0c97ba1a1d7cd900c990e6db0cf74bb260311f6215b476fA6071fc21a4fa70e0032b60937e98b8e736fcad68577f0e2f4112c927cb28feb8A075961507121901f0f86b9878dbd1e1630066471d8435142f32c6a7e6c66ab1fA555a3221593817f963ad10ce4033d1b12ae8d0235e1c33fbfbd85b27cad84b6cA14905c358e57602ca0150c9fa9535903b567177e581cd7314d1d1ca369fa1c22Adf117737389b51d227a7034d6381fb06aca00f83a24f1aa0831aa5437b57f5d8A846a93b9b1d1bb38f7ed25f99fd278a727e73afdce022288557135affc5efb0cA42013b56cc9d56c5cd951b6ddcc4f2bc386124a5632d3a21fe33876db9bcfee5A1eb518cfd93a2f09d28cd141d5199eef2db2bf8216383394a813cfcbde170b8eA6b62f7305ff33a34d21c9d9ca7af60a175fdcf11a4d050e622784b39c86ec773Af6a47087995f27c1d0c02b3d1510231f4d31ec5fd2e2a0b71057d92a641cfbb8A46d14d36bc6561ce601a46722835a435564558e41a8ac317a584da06a3024708Afa04ae3d5198bd40ecd7b91e5180b808dec7c9c8242ba5f06a103ecd2d1eac5bA672b2c598a6875ce7a4d27b46e0150712976fab434693fec0967dd01323e7b10Abcc57b2b1e0a3db7dfd32633126a888f75e95f7df876f0f29e84124896f8cc47A2bd162f5cdf19472673358ba969aeff48ac5cdee5d1c83a55312bf098ad7b9c0A3862c9189d6342fbc639252550fc1cdfab1bb341ad8da9e05720529b0c16b94eAd3d72918db88978ee245bc1b30ca310673da0154ca48ab23f058648a1eff76cfAc2dff04a77e61c3fa9ac6b95e99aa7b60c1c0893142ea4c1c8d09129b9a4ff7aAd47b5fb1d8b3fc49e0618a7ee705d158fd1b181c28d7426261953cbd7cd5cf2cA203847e49e079a3f338de7777e19a3be9dd98b797e27cb572593a3f3977415c4A80034dc674d3846e985252ca4411e0bf3081ec5cfd254c49ad723b6ab8648fccA3e460f1058b2b6356fc85daa6f39c52048babbea1dcd6bec9a70bdec541ff077A90c712f308defc9078509331d2aa5eba272bda1694de620790224d4223196020Ad29555811b1cff7b27aea8d77d24638ef3f69e0358cb3cd6396f0a9b236a726cA090ddb342225f53e759b66e5b62ebbc4a93b425fae224d86e74b65fc92a24247A1ac09633013b05f616f776905dcd4a31b9006bd3623f28d091c39f7a93db5b37A0c183f4522ff8f820347f0f6701551551544f4b5b6e80fa73b2dfcf892c54820Ac6910c559ee25af3f5b3acc2f2dbd423ca3fec3c558ddc103e4a477425640029Ab8e12dac915545405f5c2033b5cf7be19eafa8d067bc75caecc3ec932f1cd9a0A46e55532d882b1d3cc801db755b287342b9471449a4d22d0179863c6cbc2297bA90b9c7a48e0ebf17312ac6aaa95d27ca3136d0a73b0cb53a49380192141f0e54A0304fe1e7a5334d0380109433e24e0d4c963849cd803c555900eed9dc88bf0b1A487db3cb0bbe6e9f53b0f0018b29340af7bd6e21bcd72bade7fc2cb0be7439f6Ab4ead936676fdf2d2b97738eb739ccb938e9dd127465b9873f5deb4dfd71b11fA6e57a6839e9a5fb65095b2553fe81fac7c8b5bf9be957d32ec8abdfd74adbc11Ae5a1e4ceef8591a13cce56850e295364ddf7c7dbe329a423e8a1a37690c01291A0b9746077b5fe40b33c9f9ac9decd25d314abff32e390f02b5df6fca54f5ed30Af1b33612a8f64a540e595782e5d48411412b682742e78b69c5503329a8d4aa0aAc2db4cc3c4763a27a81b3fc8aa569b6f28c95c8975d6b9b8e759fa0cdcaf18c5Ad5836c45714bd20311bec1a0fdbfb94256c33fe27111c19ba955958729b90ac6Aa61bbacf7bc9db5df1f24c5b46f5a7fc76400d641c7192a777cd80c0d72bbc79A272a2132cefddbe2e87db42a58d67d02e46f168e9d4da4a11a8891878b710e6bAadd9a6b476785ccac262086331737d171466b868b9318e794849ca930dde75a0Ac2a116aa910d147bd5bdacc2f1cc4430148955f450654ed756e9c93de1b1e1d2A";

submit.classList.add("disabled");

const hash = message => sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(message));
const checkDisBtn = () => {
	if(!(email.validity.valid && q1.validity.valid && q2.validity.valid && q3.validity.valid))
		submit.classList.add("disabled");
	else
		submit.classList.remove("disabled");
};

email.addEventListener("input", event => {
	if(!email.validity.valid)
		emailError.setAttribute("data-error","Invalid email."); //poor design
	checkDisBtn();
},false);

q1.addEventListener("input", event => {
	if( q1CombHash.indexOf(hash(q1.value)) > -1)
		q1.setCustomValidity("");
	else {
		q1Error.setAttribute("data-error","Wrong answer!"); //poor design
		q1.setCustomValidity("Wrong answer!");
	}

	checkDisBtn();
}, false);

q2.addEventListener("input", event => {
	if( q2CombHash.indexOf(hash(q2.value)) > -1)
		q2.setCustomValidity("");
	else {
		q2Error.setAttribute("data-error", "Wrong answer!"); //poor design
		q2.setCustomValidity("Wrong answer!");
	}

	checkDisBtn();
}, false);

q3.addEventListener("input", event => {
	if( q3CombHash.indexOf(hash(q3.value)) > -1)
		q3.setCustomValidity("");
	else {
		q3Error.setAttribute("data-error","Wrong answer!"); //poor design
		q3.setCustomValidity("Wrong answer!");
	}

	checkDisBtn();
}, false);

form.addEventListener("submit", function (event) {
	if(!(email.validity.valid && q1.validity.valid && q2.validity.valid && q3.validity.valid))
		event.preventDefault();
}, false);